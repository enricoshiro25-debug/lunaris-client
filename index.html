<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Scuola di Magia Lunaris</title>

<style>
body {
  background: #000;
  color: #fff;
  font-family: Arial, sans-serif;
  text-align: center;
  margin: 0;
}

h1 { margin-top: 20px; }

#container {
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-top: 30px;
  flex-wrap: wrap;
}

/* AVATAR */
#avatar-box {
  width: 128px;
  height: 128px;
  position: relative;
  background: #111;
  border: 2px solid #666;
}

.avatar-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 128px;
  height: 128px;
  image-rendering: pixelated;
}

/* ordine layer */
#clothes { z-index: 1; }
#hair { z-index: 2; }
#accessories { z-index: 3; }

/* PANNELLI */
.panel {
  background: #111;
  padding: 15px;
  border: 2px solid #555;
  width: 220px;
}

input, button, select {
  width: 100%;
  margin-bottom: 8px;
  padding: 6px;
}

button { cursor: pointer; }
</style>
</head>

<body>

<h1>✨ Scuola di Magia Lunaris ✨</h1>

<div id="container">

  <!-- LOGIN / REGISTER -->
  <div class="panel">
    <h3>Account</h3>
    <input id="username" placeholder="Nome utente">
    <input id="password" type="password" placeholder="Password">
    <button onclick="register()">Registrati</button>
    <button onclick="login()">Login</button>
    <p id="msg"></p>
  </div>

  <!-- AVATAR -->
  <div>
    <div id="avatar-box">
      <img id="clothes" class="avatar-layer" src="images/clothes/base.png">
      <img id="hair" class="avatar-layer" src="images/hair/head_male.png">
      <img id="accessories" class="avatar-layer" src="">
    </div>
  </div>

  <!-- PERSONALIZZAZIONE -->
  <div class="panel">
    <h3>Aspetto</h3>

    <label>Capelli / Testa</label>
    <select onchange="setAvatar('hair', this.value)">
      <option value="images/hair/head_male.png">Uomo</option>
      <option value="images/hair/head_female.png">Donna</option>
    </select>

    <label>Accessori</label>
    <select onchange="setAvatar('accessories', this.value)">
      <option value="">Nessuno</option>
      <option value="images/accessories/hat1.png">Cappello</option>
    </select>
  </div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const username = document.getElementById('username');
  const password = document.getElementById('password');
  const msg = document.getElementById('msg');
  const clothes = document.getElementById('clothes');
  const hair = document.getElementById('hair');
  const accessories = document.getElementById('accessories');

  window.setAvatar = function(layer, src) {
    document.getElementById(layer).src = src;
  }

  window.register = function() {
    const u = username.value.trim();
    const p = password.value.trim();
    if (!u || !p) {
      msg.innerText = "Compila tutti i campi";
      return;
    }
    if (localStorage.getItem("user_" + u)) {
      msg.innerText = "Utente già registrato";
      return;
    }

    const userData = {
      password: p,
      clothes: "images/clothes/base.png",
      hair: "images/hair/head_male.png",
      accessories: ""
    };

    localStorage.setItem("user_" + u, JSON.stringify(userData));
    msg.innerText = "Registrazione completata!";
  }

  window.login = function() {
    const u = username.value.trim();
    const p = password.value.trim();
    const data = localStorage.getItem("user_" + u);

    if (!data) {
      msg.innerText = "Utente non trovato";
      return;
    }

    const user = JSON.parse(data);
    if (user.password !== p) {
      msg.innerText = "Password errata";
      return;
    }

    clothes.src = user.clothes;
    hair.src = user.hair;
    accessories.src = user.accessories;

    msg.innerText = "Benvenuto a Lunaris ✨";
  }
});
</script>

</body>
</html>
