<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Scuola di Magia Lunaris</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<h1>✨ Scuola di Magia Lunaris ✨</h1>

<div id="container">

  <!-- LOGIN / REGISTER -->
  <div class="panel">
    <h3>Account</h3>
    <input id="username" placeholder="Nome utente">
    <input id="password" type="password" placeholder="Password">
    <button onclick="register()">Registrati</button>
    <button onclick="login()">Login</button>
    <p id="msg"></p>
  </div>

  <!-- AVATAR -->
  <div>
    <div id="avatar-box">
      <img id="clothes" class="avatar-layer" src="images/clothes/robe1.png">
      <img id="face" class="avatar-layer" src="images/base/face1.png">
      <img id="hair" class="avatar-layer" src="images/hair/hair1.png">
    </div>
  </div>

  <!-- PERSONALIZZAZIONE -->
  <div class="panel">
    <h3>Aspetto</h3>

    <label>Viso</label>
    <select onchange="setAvatar('face', this.value)">
      <option value="images/base/face1.png">Face 1</option>
      <option value="images/base/face2.png">Face 2</option>
      <option value="images/base/face3.png">Face 3</option>
    </select>

    <label>Vestito</label>
    <select onchange="setAvatar('clothes', this.value)">
      <option value="images/clothes/robe1.png">Robe 1</option>
      <option value="images/clothes/robe2.png">Robe 2</option>
      <option value="images/clothes/robe3.png">Robe 3</option>
    </select>

    <label>Capelli</label>
    <select onchange="setAvatar('hair', this.value)">
      <option value="images/hair/hair1.png">Hair 1</option>
      <option value="images/hair/hair2.png">Hair 2</option>
      <option value="images/hair/hair3.png">Hair 3</option>
    </select>
  </div>

</div>

<script>
const username = document.getElementById('username');
const password = document.getElementById('password');
const msg = document.getElementById('msg');

const clothes = document.getElementById('clothes');
const face = document.getElementById('face');
const hair = document.getElementById('hair');

// Cambia immagine layer
function setAvatar(layer, src) {
  document.getElementById(layer).src = src;
}

// Registrazione
function register() {
  const u = username.value.trim();
  const p = password.value.trim();
  if(!u || !p){ msg.innerText="Compila tutti i campi"; return; }
  if(localStorage.getItem("user_"+u)){ msg.innerText="Utente già registrato"; return; }

  const userData = {
    password: p,
    clothes: "images/clothes/robe1.png",
    face: "images/base/face1.png",
    hair: "images/hair/hair1.png"
  };

  localStorage.setItem("user_"+u, JSON.stringify(userData));
  msg.innerText = "Registrazione completata!";
}

// Login
function login() {
  const u = username.value.trim();
  const p = password.value.trim();
  const data = localStorage.getItem("user_"+u);
  if(!data){ msg.innerText="Utente non trovato"; return; }

  const user = JSON.parse(data);
  if(user.password !== p){ msg.innerText="Password errata"; return; }

  clothes.src = user.clothes;
  face.src = user.face;
  hair.src = user.hair;

  msg.innerText = "Benvenuto a Lunaris ✨";
}
</script>

</body>
</html>
